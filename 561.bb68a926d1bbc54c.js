"use strict";(self.webpackChunkDatHangAngular=self.webpackChunkDatHangAngular||[]).push([[561],{1561:(ft,v,c)=>{c.r(v),c.d(v,{TmdtModule:()=>xt});var $=c(923),d=c(6895),m=c(7486),k=c(7579),C=c(2722),b=c(8746),h=c(4505),t=c(4650),w=c(5849),T=c(7455),M=c(8735),S=c(9717),J=c(859),x=c(805),Z=c(666),A=c(1740),O=c(3054),N=c(7188),D=c(5593),g=c(4006);function P(i,r){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"app-image-select",13),t.NdJ("imageOutput",function(o){t.CHM(e);const a=t.oxw().$implicit,l=t.oxw();return t.KtG(l.output[a.field]=o)}),t.qZA(),t.BQk()}}function I(i,r){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"textarea",14),t.NdJ("ngModelChange",function(o){t.CHM(e);const a=t.oxw().$implicit,l=t.oxw();return t.KtG(l.output[a.field]=o)})("ngModelChange",function(o){t.CHM(e);const a=t.oxw().$implicit,l=t.oxw();return t.KtG(l.changeValue(a,o))}),t.qZA(),t.BQk()}if(2&i){const e=t.oxw().$implicit,n=t.oxw();t.xp6(1),t.Q6J("autoResize",!0)("ngModel",n.output[e.field])}}function Q(i,r){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"input",15),t.NdJ("ngModelChange",function(o){t.CHM(e);const a=t.oxw().$implicit,l=t.oxw();return t.KtG(l.output[a.field]=o)})("ngModelChange",function(o){t.CHM(e);const a=t.oxw().$implicit,l=t.oxw();return t.KtG(l.changeValue(a,o))}),t.qZA(),t.BQk()}if(2&i){const e=t.oxw().$implicit,n=t.oxw();t.xp6(1),t.Q6J("ngModel",n.output[e.field])}}function F(i,r){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"p-inputNumber",16),t.NdJ("ngModelChange",function(o){t.CHM(e);const a=t.oxw().$implicit,l=t.oxw();return t.KtG(l.output[a.field]=o)})("ngModelChange",function(o){t.CHM(e);const a=t.oxw().$implicit,l=t.oxw();return t.KtG(l.commonService.autoCalculatePrices(l.output,a,o))}),t.qZA(),t.BQk()}if(2&i){const e=t.oxw().$implicit,n=t.oxw();let o;t.xp6(1),t.Q6J("minFractionDigits",0)("maxFractionDigits",5)("inputStyleClass",null!==(o=e.className)&&void 0!==o?o:"input-number")("ngModel",n.output[e.field])}}const Y=function(){return[]};function H(i,r){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"p-dropdown",17),t.NdJ("ngModelChange",function(o){t.CHM(e);const a=t.oxw().$implicit,l=t.oxw();return t.KtG(l.output[a.field]=o)})("onChange",function(o){t.CHM(e);const a=t.oxw().$implicit,l=t.oxw();return t.KtG(l.changeValue(a,o.value))}),t.qZA(),t.BQk()}if(2&i){const e=t.oxw().$implicit,n=t.oxw();let o;t.xp6(1),t.Q6J("filter",!e.filter.noFilterOnRow)("options",null!==(o=e.filter.dropdownOptions)&&void 0!==o?o:t.DdM(6,Y))("showClear",!1)("readonly",!1)("placeholder","Ch\u1ecdn "+e.name)("ngModel",n.output[e.field])}}function E(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"textarea",19),t.NdJ("ngModelChange",function(o){t.CHM(e);const a=t.oxw(2).$implicit,l=t.oxw();return t.KtG(l.output[a.field]=o)})("ngModelChange",function(o){t.CHM(e);const a=t.oxw(2).$implicit,l=t.oxw();return t.KtG(l.changeValue(a,o))}),t.qZA()}if(2&i){const e=t.oxw(2).$implicit,n=t.oxw();t.Q6J("ngModel",n.output[e.field])}}function L(i,r){1&i&&(t.ynx(0),t.YNc(1,E,1,1,"ng-template",18),t.BQk())}function G(i,r){if(1&i&&(t.TgZ(0,"div",20),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit,n=t.oxw();t.xp6(1),t.hij(" ",n.output["tooltip_"+e.field]," ")}}function K(i,r){if(1&i&&(t.ynx(0),t.TgZ(1,"div",6)(2,"div",7),t._uU(3),t.qZA(),t.TgZ(4,"div",8),t.ynx(5,9),t.YNc(6,P,2,0,"ng-container",10),t.YNc(7,I,2,2,"ng-container",10),t.YNc(8,Q,2,1,"ng-container",10),t.YNc(9,F,2,4,"ng-container",10),t.YNc(10,H,2,7,"ng-container",10),t.YNc(11,L,2,0,"ng-container",11),t.BQk(),t.YNc(12,G,2,1,"div",12),t.qZA()(),t.BQk()),2&i){const e=r.$implicit,n=t.oxw();t.xp6(3),t.hij(" ",e.name," "),t.xp6(2),t.Q6J("ngSwitch",e.type),t.xp6(1),t.Q6J("ngSwitchCase","image"),t.xp6(1),t.Q6J("ngSwitchCase","link"),t.xp6(1),t.Q6J("ngSwitchCase","string"),t.xp6(1),t.Q6J("ngSwitchCase","number"),t.xp6(1),t.Q6J("ngSwitchCase","dropdown"),t.xp6(2),t.Q6J("ngIf",n.output["tooltip_"+e.field])}}let B=(()=>{class i{constructor(e,n,o,a,l){this.dialogService=e,this.ref=n,this.firebaseService=o,this.toastService=a,this.commonService=l,this.output={status:5,weight_price:this.firebaseService.DEFAULT_WEIGHT_PRICE$.value,exchange:this.firebaseService.DEFAULT_EXCHANGE$.value},this.IMG_DEFAULT=h.jC,this.data=this.dialogService.data.data}ngOnInit(){}changeValue(e,n){this.output[e.field]=n,console.log(e,n),console.log("output",this.output),this.output=JSON.parse(JSON.stringify(this.output))}submit(){console.log("Submit",this.output),this.output.customer?this.dialogService.data.callBackAdded(this.output):this.toastService.showToastWarning("Ch\u01b0a nh\u1eadp t\xean kh\xe1ch h\xe0ng!")}close(){this.ref.close()}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(w.S),t.Y36(w.E7),t.Y36(T.O),t.Y36(M.k),t.Y36(S.v))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-add-modal"]],decls:6,vars:1,consts:[[1,"wrap-modal"],[1,"wrap-input"],[4,"ngFor","ngForOf"],[1,"d-flex","aligin-items-center","justify-content-end","actions-wrap","mt-4"],["label","Cancel","styleClass","mx-2 p-button-outlined  p-button-secondary","icon","pi pi-times",3,"onClick"],["label","Add","styleClass","p-button-success","icon","pi pi-plus",3,"onClick"],[1,"d-flex","justify-content-between","my-2"],[1,"label"],[1,"value-input"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["class","mt-2 message text-info",4,"ngIf"],[3,"imageOutput"],["cols","25","pInputTextarea","",3,"autoResize","ngModel","ngModelChange"],["pInputText","",3,"ngModel","ngModelChange"],["mode","decimal",3,"minFractionDigits","maxFractionDigits","inputStyleClass","ngModel","ngModelChange"],["id","value","optionLabel","name","optionValue","value",3,"filter","options","showClear","readonly","placeholder","ngModel","ngModelChange","onChange"],["pTemplate","input"],["pInputTextarea","",3,"ngModel","ngModelChange"],[1,"mt-2","message","text-info"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,K,13,8,"ng-container",2),t.qZA(),t.TgZ(3,"div",3)(4,"p-button",4),t.NdJ("onClick",function(){return o.close()}),t.qZA(),t.TgZ(5,"p-button",5),t.NdJ("onClick",function(){return o.submit()}),t.qZA()()()),2&n&&(t.xp6(2),t.Q6J("ngForOf",o.data))},dependencies:[d.sg,d.O5,d.RF,d.n9,d.ED,J.Y,x.jx,Z.Lt,A.o,O.g,N.Rn,D.zx,g.Fj,g.JJ,g.On],styles:[".wrap-modal[_ngcontent-%COMP%]     .wrap-input{display:grid;grid-template-columns:auto auto;gap:10px 60px}.wrap-modal[_ngcontent-%COMP%]     .wrap-input .label{width:100px}.wrap-modal[_ngcontent-%COMP%]     .wrap-input .value-input{flex:1}.wrap-modal[_ngcontent-%COMP%]     .wrap-input .value-input .input-number, .wrap-modal[_ngcontent-%COMP%]     .wrap-input .value-input .message, .wrap-modal[_ngcontent-%COMP%]     .wrap-input .value-input input{width:100%}.wrap-modal[_ngcontent-%COMP%]     .wrap-input .value-input .message{white-space:pre-line;font-size:.8rem}.wrap-modal[_ngcontent-%COMP%]     .actions-wrap{text-align:right}.wrap-modal[_ngcontent-%COMP%]     .actions-wrap button{width:120px}@media (max-width: 700px){.wrap-modal[_ngcontent-%COMP%]     .wrap-input{display:grid;grid-template-columns:auto;gap:10px 60px}.wrap-modal[_ngcontent-%COMP%]     .wrap-input .label{width:100px}.wrap-modal[_ngcontent-%COMP%]     .wrap-input .value-input{flex:1}.wrap-modal[_ngcontent-%COMP%]     .wrap-input .value-input .input-number, .wrap-modal[_ngcontent-%COMP%]     .wrap-input .value-input textarea, .wrap-modal[_ngcontent-%COMP%]     .wrap-input .value-input p-inputnumber, .wrap-modal[_ngcontent-%COMP%]     .wrap-input .value-input p-inputnumber>span, .wrap-modal[_ngcontent-%COMP%]     .wrap-input .value-input .message, .wrap-modal[_ngcontent-%COMP%]     .wrap-input .value-input input{width:100%}.wrap-modal[_ngcontent-%COMP%]     .actions-wrap{text-align:right}.wrap-modal[_ngcontent-%COMP%]     .actions-wrap button{width:120px}}"]})}return i})();var U=c(7963),f=c(3970),R=c(4076),j=c(3608);function z(i,r){if(1&i&&(t.ynx(0),t.TgZ(1,"th",8)(2,"div",9),t._uU(3),t.qZA()(),t.BQk()),2&i){const e=r.$implicit;t.xp6(1),t.s9C("pSortableColumn",e.field),t.Q6J("ngClass",e.headerClassName)("ngStyle",e.styles),t.xp6(2),t.hij(" ",e.name," ")}}function V(i,r){if(1&i&&(t.TgZ(0,"tr"),t.YNc(1,z,4,4,"ng-container",7),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.headers)}}function q(i,r){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"img",18,19),t.NdJ("click",function(){t.CHM(e);const o=t.MAs(2),a=t.oxw().$implicit,l=t.oxw().$implicit,s=t.oxw(),u=t.MAs(1);return t.KtG(s.openSelectFile(l,a.field,u,o))}),t.qZA(),t.BQk()}if(2&i){const e=t.oxw().$implicit,n=t.oxw().$implicit,o=t.oxw();let a;t.xp6(1),t.Q6J("src",null!==(a=n[e.field])&&void 0!==a?a:o.IMG_DEFAULT,t.LSH)}}function W(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"input",22),t.NdJ("ngModelChange",function(o){t.CHM(e);const a=t.oxw(2).$implicit,l=t.oxw().$implicit;return t.KtG(l[a.field]=o)})("change",function(){t.CHM(e);const o=t.oxw(2).$implicit,a=t.oxw().$implicit,l=t.oxw();return t.KtG(l.changeValue(a,o,a[o.field]))})("keydown",function(o){t.CHM(e);const a=t.oxw(2).$implicit,l=t.oxw().$implicit,s=t.oxw();return t.KtG(s.keyHandler(o,l,a,l[a.field]))}),t.qZA(),t.TgZ(1,"span",23),t._uU(2),t.qZA()}if(2&i){const e=t.oxw(2).$implicit,n=t.oxw().$implicit;t.Q6J("ngStyle",e.styles)("ngModel",n[e.field]),t.xp6(2),t.hij(" ",n[e.field],"")}}function X(i,r){if(1&i&&t._uU(0),2&i){const e=t.oxw(2).$implicit,n=t.oxw().$implicit;t.hij(" ",n[e.field]," ")}}function tt(i,r){1&i&&(t.ynx(0),t.TgZ(1,"p-cellEditor"),t.YNc(2,W,3,3,"ng-template",20),t.YNc(3,X,1,1,"ng-template",21),t.qZA(),t.BQk())}function et(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"p-inputNumber",24),t.NdJ("ngModelChange",function(o){t.CHM(e);const a=t.oxw(2).$implicit,l=t.oxw().$implicit;return t.KtG(l[a.field]=o)})("focusout",function(){t.CHM(e);const o=t.oxw(2).$implicit,a=t.oxw().$implicit,l=t.oxw();return t.KtG(l.changeValue(a,o,a[o.field]))})("ngModelChange",function(o){t.CHM(e);const a=t.oxw(2).$implicit,l=t.oxw().$implicit,s=t.oxw();return t.KtG(s.commonService.autoCalculatePrices(l,a,o))})("keydown",function(o){t.CHM(e);const a=t.oxw(2).$implicit,l=t.oxw().$implicit,s=t.oxw();return t.KtG(s.keyHandler(o,l,a,l[a.field]))}),t.qZA()}if(2&i){const e=t.oxw(2).$implicit,n=t.oxw().$implicit;t.Q6J("ngModel",n[e.field])("inputStyle",e.styles)("minFractionDigits",0)("maxFractionDigits",5)}}function nt(i,r){if(1&i&&(t._uU(0),t.ALo(1,"number")),2&i){const e=t.oxw(2).$implicit,n=t.oxw().$implicit;t.hij(" ",0==+n[e.field]?"-":t.lcZ(1,1,+n[e.field])," ")}}function ot(i,r){1&i&&(t.ynx(0),t.TgZ(1,"p-cellEditor"),t.YNc(2,et,1,4,"ng-template",20),t.YNc(3,nt,2,3,"ng-template",21),t.qZA(),t.BQk())}function it(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"textarea",25),t.NdJ("ngModelChange",function(o){t.CHM(e);const a=t.oxw(2).$implicit,l=t.oxw().$implicit;return t.KtG(l[a.field]=o)})("change",function(){t.CHM(e);const o=t.oxw(2).$implicit,a=t.oxw().$implicit,l=t.oxw();return t.KtG(l.changeValue(a,o,a[o.field]))})("keydown",function(o){t.CHM(e);const a=t.oxw(2).$implicit,l=t.oxw().$implicit,s=t.oxw();return t.KtG(s.keyHandler(o,l,a,l[a.field]))}),t.qZA()}if(2&i){const e=t.oxw(2).$implicit,n=t.oxw().$implicit;t.Q6J("ngStyle",e.styles)("ngModel",n[e.field])}}function at(i,r){if(1&i&&t._uU(0),2&i){const e=t.oxw(2).$implicit,n=t.oxw().$implicit;t.hij(" ",n[e.field]," ")}}function lt(i,r){1&i&&(t.ynx(0),t.TgZ(1,"p-cellEditor"),t.YNc(2,it,1,2,"ng-template",20),t.YNc(3,at,1,1,"ng-template",21),t.qZA(),t.BQk())}const ct=function(i){return{display:i}};function rt(i,r){if(1&i&&(t.TgZ(0,"td",12)(1,"span",13),t._uU(2),t.qZA(),t.TgZ(3,"div",14),t.ynx(4,15),t.YNc(5,q,3,1,"ng-container",16),t.YNc(6,tt,4,0,"ng-container",16),t.YNc(7,ot,4,0,"ng-container",16),t.YNc(8,lt,4,0,"ng-container",17),t.BQk(),t.qZA()()),2&i){const e=r.$implicit,n=t.oxw().$implicit;t.Q6J("ngClass",e.className)("ngStyle",t.VKq(10,ct,n["_hide_"+e.field]?"none":"table-cell")),t.uIk("rowspan",n["_rowspan_"+e.field]),t.xp6(2),t.Oqu(e.name),t.xp6(1),t.Q6J("ngStyle",e.styles)("pTooltip",n["tooltip_"+e.field]),t.xp6(1),t.Q6J("ngSwitch",e.type),t.xp6(1),t.Q6J("ngSwitchCase","image"),t.xp6(1),t.Q6J("ngSwitchCase","string"),t.xp6(1),t.Q6J("ngSwitchCase","number")}}const st=function(i){return{newly:i}};function pt(i,r){if(1&i&&(t.ynx(0),t.TgZ(1,"tr",10),t.YNc(2,rt,9,12,"td",11),t.qZA(),t.BQk()),2&i){const e=r.$implicit,n=t.oxw();t.xp6(1),t.Q6J("ngClass",t.VKq(3,st,n.checkNewlyUpdate(e.created)))("pContextMenuRow",e),t.xp6(1),t.Q6J("ngForOf",n.headers)}}const _t=function(){return[10,25,50,100,500,1e3]},dt=function(){return{flex:1,width:"100%"}};let gt=(()=>{class i{constructor(e,n,o,a){this.toastService=e,this.confirmationService=n,this.firebaseService=o,this.commonService=a,this.dataTable=[],this.valueChanged=new t.vpe,this.contextMenuOutput=new t.vpe,this.renderLink=h.KJ,this.IMG_DEFAULT=h.jC,this.currentTime=Date.now()}ngOnInit(){this.contextMenu=[{label:"Clone a copy",icon:"pi pi-fw pi-copy",command:()=>this.cloneACopy()},{label:"Delete",icon:"pi pi-fw pi-times",command:()=>this.confirmDelete()}]}ngOnChanges(e){this.currentTime=Date.now()}cloneACopy(){this.contextMenuOutput.emit({type:m.MW.CLONE_A_COPY,value:this.selectedItem}),this.selectedItem={}}confirmDelete(){this.confirmationService.confirm({message:`Do you want to delete this record: ${this.selectedItem.sku}?`,header:"Delete Confirmation",icon:"pi pi-info-circle",rejectButtonStyleClass:"bg-danger",accept:()=>{this.contextMenuOutput.emit({type:m.MW.DELETE_ACCEPT,value:this.selectedItem}),this.selectedItem={}},reject:e=>{this.contextMenuOutput.emit({type:m.MW.DELETE_REJECT_CANCEL,value:this.selectedItem}),this.selectedItem={}}})}openSelectFile(e,n,o,a){o.data={item:e,field:n,image:a},o.click()}changeValue(e,n,o){console.log({item:e},n,o),this.valueChanged.emit({item:e,header:n,value:o})}changeImg(e,n){console.log({fileElement:e},n),(0,h.pQ)(e,o=>{e.data.image.src=o,this.valueChanged.emit({item:e.data.item,header:{field:e.data.field},value:o})})}keyHandler(e,n,o,a){("Enter"===e.key||13===e.keyCode)&&(console.log("Enter",n),this.changeValue(n,o,a))}checkNewlyUpdate(e){return Date.now()-e<3e3}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(M.k),t.Y36(x.YP),t.Y36(T.O),t.Y36(S.v))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["tmdt-table"]],inputs:{dataTable:"dataTable",headers:"headers",isLoading:"isLoading"},outputs:{valueChanged:"valueChanged",contextMenuOutput:"contextMenuOutput"},features:[t.TTD],decls:7,vars:14,consts:[["type","file","accept","image/*",1,"d-none",3,"change"],["inputImg",""],[3,"model"],["cm",""],["responsiveLayout","stack","dataKey","_id","currentPageReportTemplate","{first} - {last} / {totalRecords}",1,"w-full",3,"value","breakpoint","rows","rowsPerPageOptions","paginator","showCurrentPageReport","contextMenuSelection","contextMenu","rowHover","tableStyle","loading","contextMenuSelectionChange"],["pTemplate","header"],["pTemplate","body"],[4,"ngFor","ngForOf"],[1,"table-header",3,"ngClass","ngStyle","pSortableColumn"],[1,"flex","align-items-center"],[3,"ngClass","pContextMenuRow"],[3,"ngClass","ngStyle",4,"ngFor","ngForOf"],[3,"ngClass","ngStyle"],[1,"p-column-title","mr-2"],[1,"table-cell",3,"ngStyle","pTooltip"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"cursor-pointer",3,"src","click"],["image",""],["pTemplate","input"],["pTemplate","output"],["pInputText","",3,"ngStyle","ngModel","ngModelChange","change","keydown"],[1,"invisible"],["mode","decimal",3,"ngModel","inputStyle","minFractionDigits","maxFractionDigits","ngModelChange","focusout","keydown"],["pInputTextarea","",3,"ngStyle","ngModel","ngModelChange","change","keydown"]],template:function(n,o){if(1&n){const a=t.EpF();t.TgZ(0,"input",0,1),t.NdJ("change",function(s){t.CHM(a);const u=t.MAs(1);return t.KtG(o.changeImg(u,s))}),t.qZA(),t._UZ(2,"p-contextMenu",2,3),t.TgZ(4,"p-table",4),t.NdJ("contextMenuSelectionChange",function(s){return o.selectedItem=s}),t.YNc(5,V,2,1,"ng-template",5),t.YNc(6,pt,3,5,"ng-template",6),t.qZA()}if(2&n){const a=t.MAs(3);t.xp6(2),t.Q6J("model",o.contextMenu),t.xp6(2),t.Q6J("value",o.dataTable)("breakpoint","960px")("rows",25)("rowsPerPageOptions",t.DdM(12,_t))("paginator",!1)("showCurrentPageReport",!0)("contextMenuSelection",o.selectedItem)("contextMenu",a)("rowHover",!1)("tableStyle",t.DdM(13,dt))("loading",o.isLoading)}},dependencies:[d.mk,d.sg,d.PC,d.RF,d.n9,d.ED,f.iA,x.jx,f.lQ,f.zi,f.YL,A.o,O.g,N.Rn,R.xV,j.u,g.Fj,g.JJ,g.On,d.JJ],styles:["[_nghost-%COMP%]     .newly td:nth-child(n+2){background-color:#d7ffe6}@media only screen and (min-width: 800px){[_nghost-%COMP%]     .p-datatable .p-datatable-thead>tr>th{color:#fff;background:#11101d}[_nghost-%COMP%]     .p-datatable-wrapper{height:calc(100vh - 70px)}[_nghost-%COMP%]     .p-datatable-wrapper .p-datatable-thead{position:sticky;top:0;z-index:1}}"]})}return i})(),ut=(()=>{class i{constructor(e,n,o,a){this.toastService=e,this.dialogService=n,this.firebaseService=o,this.confirmationService=a,this.numberDefaultConfig={name:"",field:"",type:"number",filter:{noFilter:!0},styles:{"text-align":"right"}},this.headers=[],this.orders=[],this.isLoading=!0,this.$destroy=new k.x}ngOnInit(){this.getTableHeader(),this.firebaseService.loadSetting(()=>{this.getData()})}valueChanged(e){}showAddModal(){this.ref=this.dialogService.open(B,{header:"\u0110\u01a1n h\xe0ng m\u1edbi",contentStyle:{overflow:"auto"},maximizable:!0,baseZIndex:1e4,data:{data:this.headers,callBackAdded:e=>{this.addItem(e)}}}),this.ref.onClose.subscribe(()=>{this.getData()})}contextMenuClick(e){console.log(e)}getTableHeader(){this.headers=[{name:"SKU",field:"sku",type:"string",filter:{},styles:{"text-align":"center"}},{name:"Image",field:"imageLink",type:"image",className:"image-col",filter:{noFilter:!0},styles:{"text-align":"center"}},{name:"M\xc0U",field:"prop_color",type:"string",filter:{},styles:{"text-align":"center"}},{name:"SIZE",field:"prop_size",type:"string",filter:{},styles:{"text-align":"center"}},{...this.numberDefaultConfig,name:"\u0110\xc3 NH\u1eacP",field:"quantity"},{...this.numberDefaultConfig,name:"\u0110\xc3 B\xc1N",field:"orderID"},{...this.numberDefaultConfig,name:"GI\xc1 V\u1ed0N",field:"price",className:"text-danger"},{...this.numberDefaultConfig,name:"DOANH THU",className:"text-danger"},{name:"UPDATE",field:"",className:"text-danger",type:"string",filter:{},styles:{"text-align":"center"}}]}getData(){this.isLoading=!0,this.orders=[],this.firebaseService.getTmdt().pipe((0,C.R)(this.$destroy),(0,b.x)(()=>this.isLoading=!1)).subscribe(e=>{console.log(e),e.sort((n,o)=>n.created<o.created?1:-1),this.orders=this.groupByProps(e),this.orders=this.mergeColsRows(this.orders)})}mergeColsRows(e){let n=JSON.parse(JSON.stringify(e)),o={rowspan:0,currentSku:"",currentIndex:0},a={rowspan:0,current:"",currentIndex:0},l={rowspan:0,current:"",currentIndex:0};function s(p,_){n[o.currentIndex]._rowspan_sku=o.rowspan,n[o.currentIndex]._rowspan_imageLink=o.rowspan,o.currentIndex=p,o.rowspan=1,o.currentSku=_.sku??""}function u(p,_,Ct=!0){n[a.currentIndex]._rowspan_prop_color=a.rowspan,a.currentIndex=p,a.rowspan=1,a.current=_.prop_color??""}function y(p,_){n[l.currentIndex]._rowspan_prop_size=l.rowspan,l.currentIndex=p,l.rowspan=1,l.current=_.prop_size??""}for(let p=0;p<n.length;p++){const _=n[p];console.log(_),_.sku===o.currentSku?(n[p]._hide_sku=!0,n[p]._hide_imageLink=!0,o.rowspan++,p==n.length-1&&s(p,_),_.prop_color===a.current?(n[p]._hide_prop_color=!0,a.rowspan++,p==n.length-1&&u(p,_)):(u(p,_),_.prop_size===l.current?(n[p]._hide_prop_size=!0,l.rowspan++,p==n.length-1&&y(p,_)):y(p,_))):(s(p,_),u(p,_),y(p,_))}return console.log(n),n}groupByProps(e){const n=(0,m.bo)().map(l=>l.id);let o=JSON.parse(JSON.stringify(e));console.log("propsId",n),console.log("groupByProps before sort",e);const a=o.sort((l,s)=>l.sku===s.sku?l[n[0]]===s[n[0]]?l[n[1]]===s[n[1]]?(l.created||0)<(s.created||0)?1:-1:+l[n[1]]>+s[n[1]]?1:-1:l[n[0]]>s[n[0]]?1:-1:l.sku>s.sku?1:-1);return console.log("groupByProps",a),a}addItem(e){this.firebaseService.addTMDT(e).pipe((0,C.R)(this.$destroy)).subscribe(n=>{console.log("added",n),this.toastService.showToastSuccess(`Added new order ${e.sku} successfully!`),this.getData()})}updateItem(e,n,o){this.isLoading=!0,this.firebaseService.fbUpdateProducts(e,n).pipe((0,C.R)(this.$destroy),(0,b.x)(()=>this.isLoading=!1)).subscribe(a=>{this.toastService.showToastSuccess(`${o} successfully!`),this.ref.close(),this.getData()})}ngOnDestroy(){this.$destroy.next(),this.$destroy.complete(),this.ref&&this.ref.close()}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(M.k),t.Y36(w.xA),t.Y36(T.O),t.Y36(x.YP))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-tmdt"]],decls:3,vars:5,consts:[[3,"headers","dataTable","isLoading","valueChanged","contextMenuOutput"],[1,"flat-button-add"],[3,"model","hideOnClickOutside","onClick"]],template:function(n,o){1&n&&(t.TgZ(0,"tmdt-table",0),t.NdJ("valueChanged",function(l){return o.valueChanged(l)})("contextMenuOutput",function(l){return o.contextMenuClick(l)}),t.qZA(),t.TgZ(1,"div",1)(2,"p-speedDial",2),t.NdJ("onClick",function(){return o.showAddModal()}),t.qZA()()),2&n&&(t.Q6J("headers",o.headers)("dataTable",o.orders)("isLoading",o.isLoading),t.xp6(2),t.Q6J("model",o.actionMenuItems)("hideOnClickOutside",!1))},dependencies:[U.V,gt],styles:["[_nghost-%COMP%]     .image-col img{width:100px}[_nghost-%COMP%]     .flat-button-add{position:fixed;bottom:90px;right:80px}[_nghost-%COMP%]     .flat-button-add .p-speeddial-action{text-decoration:none}"]})}return i})();var mt=c(3913);const ht=[{path:"",component:ut}];let xt=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[d.ez,$.Bz.forChild(ht),mt.m,g.u5]})}return i})()}}]);